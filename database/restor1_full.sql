-- Restor-1 Complete Database
-- MySQL 8.0+

DROP DATABASE IF EXISTS restor1_db;
CREATE DATABASE restor1_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE restor1_db;

-- Таблица ресторанов
CREATE TABLE restaurants (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL,
    address TEXT NOT NULL,
    phone VARCHAR(100),
    type VARCHAR(100),
    rating DECIMAL(2,1) DEFAULT 0.0,
    latitude DECIMAL(10, 8),
    longitude DECIMAL(11, 8),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_name (name),
    INDEX idx_rating (rating),
    INDEX idx_location (latitude, longitude)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Таблица блюд
CREATE TABLE dishes (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL,
    category VARCHAR(100),
    price DECIMAL(10,2) NOT NULL,
    description TEXT,
    ingredients TEXT,
    time_to_prepare VARCHAR(50),
    image_url VARCHAR(500),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_name (name),
    INDEX idx_category (category),
    INDEX idx_price (price)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Связь ресторанов и блюд
CREATE TABLE restaurant_dishes (
    id INT PRIMARY KEY AUTO_INCREMENT,
    restaurant_id INT NOT NULL,
    dish_id INT NOT NULL,
    FOREIGN KEY (restaurant_id) REFERENCES restaurants(id) ON DELETE CASCADE,
    FOREIGN KEY (dish_id) REFERENCES dishes(id) ON DELETE CASCADE,
    UNIQUE KEY unique_rest_dish (restaurant_id, dish_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Вставка ресторанов (43 шт)
INSERT INTO restaurants (id, name, address, phone, type, rating, latitude, longitude) VALUES
(1, 'TomYumbar', 'БЦ Алтын Заман, проспект Сейфуллина, 498', '+77070015050', 'Ресторан', 4.8, 43.2622, 76.9286),
(2, 'Alani Kabab', 'Улица Поддубного, 90', '+77777041556', 'Кафе', 4.5, 43.2401, 76.8801),
(3, 'Щука. Бистро', 'Улица Радостовца, 333а', '+7-708-709-45-05', 'Кафе', 4.8, 43.2267, 76.9121),
(4, 'Шашлыкоff', 'Улица Толе би, 207/1', '+7-707-835-08-88', 'Ресторан', 4.7, 43.2384, 76.9298),
(5, 'Sunqar bar', 'Проспект Аль-Фараби, 128в', '+7-707-736-03-60', 'Ресторан', 4.5, 43.2098, 76.8956),
(6, 'Сорбон', 'улица Манаса, 75в', '+77074957219', 'Ресторан', 4.5, 43.2485, 76.9123),
(7, 'Han Qauap', 'микрорайон Казахфильм, 18а', '+7-747-682-34-36', 'Кафе', 4.5, 43.2501, 76.9198),
(8, 'Sybaga Ethno', 'микрорайон Шугыла, 340/52', '+7-700-177-73-81', 'Ресторан', 4.7, 43.2588, 76.9453),
(9, 'Каусар', '5-й микрорайон, 12а', '+7-777-343-33-66', 'Чайхана', 4.7, 43.2374, 76.9453),
(10, 'Ocean street', 'микрорайон Орбита-3, 1', '+7-776-162-82-87', 'Кафе', 4.8, 43.2567, 76.9286),
(11, 'SteakMaster', 'проспект Гагарина, 206в', '+7-776-199-94-84', 'Кафе', 4.8, 43.2220, 76.8512),
(12, 'DURUM', 'улица Радостовца, 292/4а', '+7-747-803-54-98', 'Кафе', 4.8, 43.2289, 76.9134),
(13, 'Marshal', 'улица Манаса, 66', '+7-700-070-72-01', 'Кафе', 4.8, 43.2478, 76.9089),
(14, 'Лагманхана Sabro', 'проспект Турара Рыскулова, 149', '+7-707-326-11-77', 'Кафе', 4.5, 43.2156, 76.8234),
(15, 'Rumi', 'Проспект Абылай хана, 92а', '+7-747-540-40-40', 'Кафе', 4.5, 43.2634, 76.9467),
(16, 'Burger na Abaya', 'Проспект Сейфуллина, 533', '+7-708-984-89-76', 'Кафе', 4.8, 43.2645, 76.9389),
(17, 'Sushibox', 'Улица Панфилова, 75', '+7-700-818-80-80', 'Доставка', 4.8, 43.2567, 76.9467),
(18, 'Finik', 'Улица Желтоксан, 148', '+7-707-365-12-12', 'Ресторан', 4.5, 43.2534, 76.9345),
(19, 'Abi Tamasha', 'Улица Байтурсынова, 141', '+7-709-010-39-69', 'Донерная', 4.8, 43.2423, 76.9234),
(20, 'Шиша Premium', 'проспект Серкебаева, 101', '+7-705-847-78-55', 'Бар', 4.9, 43.2112, 76.8867),
(21, 'Satori', 'Улица Маметовой, 25', '+7-707-773-77-60', 'Ресторан', 4.8, 43.2589, 76.9378),
(22, 'Есть Хинкали', 'Улица Наурызбай батыра, 78', '+7-702-018-97-89', 'Ресторан', 4.5, 43.2545, 76.9423),
(23, 'Даулет', 'Улица Самен батыра, 37а', '+7-775-947-55-56', 'Кафе', 4.6, 43.2912, 76.6234),
(24, 'Bratskiy Shashlyk', 'Улица Баянаульская, 46/1', '+7-707-547-07-77', 'Кафе', 5.0, 43.2334, 76.9567),
(25, 'Penka', 'Проспект Сейфуллина, 574/6', '+7-702-637-62-28', 'Ресторан', 4.7, 43.2656, 76.9234),
(26, 'Шашлычный Двор', 'Улица Айтиева, 7', '+7-747-569-58-33', 'Кафе', 4.7, 43.2512, 76.9456),
(27, 'Mangal Grill', 'Улица Сатпаева, 90/25Б', '+7-771-929-20-80', 'Кафе', 4.6, 43.2223, 76.9012),
(28, 'Breakfast M', 'Улица Кунаева, 132', '+7-771-929-20-80', 'Кафе', 4.8, 43.2489, 76.9634),
(29, 'Fish House', 'Улица Шакарима, 12', '+7-777-534-48-88', 'Кафе', 4.9, 43.2398, 76.9456),
(30, 'Babilo', 'Микрорайон Жулдыз-2, 55/1', '+7-702-486-39-99', 'Ресторан', 4.8, 43.2445, 76.8734),
(31, 'Tombik', 'Улица Абая, 23д', '+7-700-204-22-04', 'Кафе', 4.6, 43.2912, 76.6234);

-- Вставка блюд (30 шт)
INSERT INTO dishes (id, name, category, price, description, ingredients) VALUES
(1, 'Том Ям с морепродуктами', 'Тайская кухня', 3500, 'Острый кисло-сладкий суп с креветками', 'креветки,кальмары,лемонграсс,лайм'),
(2, 'Пад Тай', 'Тайская кухня', 2800, 'Лапша с креветками и арахисом', 'лапша,креветки,арахис,яйцо'),
(3, 'Роллы Филадельфия', 'Японская кухня', 2200, 'Роллы с лососем и сыром', 'лосось,сыр,огурец,рис'),
(4, 'Хинкали с мясом', 'Грузинская кухня', 450, 'Грузинские пельмени', 'говядина,свинина,тесто,лук'),
(5, 'Долма', 'Кавказская кухня', 2500, 'Виноградные листья с мясом', 'листья,баранина,рис'),
(6, 'Борщ украинский', 'Украинская кухня', 1800, 'Красный борщ с мясом', 'свекла,мясо,капуста'),
(7, 'Донер с курицей', 'Турецкая кухня', 1500, 'Курица в лаваше', 'курица,лаваш,овощи'),
(8, 'Лагман', 'Уйгурская кухня', 2200, 'Лапша с мясом и овощами', 'лапша,мясо,перец'),
(9, 'Шашлык из баранины', 'Кавказская кухня', 3200, 'Шашлык из баранины', 'баранина,лук,специи'),
(10, 'Бешбармак', 'Казахская кухня', 3500, 'Мясо с лапшой', 'конина,тесто,лук'),
(11, 'Креветки гриль', 'Морепродукты', 4500, 'Креветки на гриле', 'креветки,чеснок,лимон'),
(12, 'Стейк Рибай', 'Стейки', 7500, 'Мраморный стейк', 'говядина,специи'),
(13, 'Дурум', 'Турецкая кухня', 1800, 'Лаваш с мясом', 'лаваш,мясо,овощи'),
(14, 'Бургер с беконом', 'Бургеры', 2500, 'Бургер с беконом', 'говядина,бекон,сыр'),
(15, 'Паста Карбонара', 'Итальянская кухня', 2800, 'Паста с беконом', 'паста,бекон,сливки'),
(16, 'Чикен Бургер', 'Бургеры', 2200, 'Куриный бургер', 'курица,салат,соус'),
(17, 'Суши сет', 'Японская кухня', 4500, 'Набор суши', 'лосось,тунец,рис'),
(18, 'Плов узбекский', 'Узбекская кухня', 2500, 'Плов с бараниной', 'рис,баранина,морковь'),
(19, 'Лаваш с мясом', 'Турецкая кухня', 1600, 'Лаваш с говядиной', 'лаваш,говядина'),
(20, 'Сашими', 'Японская кухня', 5500, 'Свежая рыба', 'лосось,тунец'),
(21, 'Хачапури', 'Грузинская кухня', 1800, 'Лодочка с сыром', 'тесто,сыр,яйцо'),
(22, 'Пицца Маргарита', 'Итальянская кухня', 2400, 'Пицца с моцареллой', 'тесто,моцарелла'),
(23, 'Люля-кебаб', 'Кавказская кухня', 2800, 'Рубленый шашлык', 'баранина,лук'),
(24, 'Омлет с лососем', 'Завтраки', 1900, 'Омлет с рыбой', 'яйца,лосось'),
(25, 'Сибас на гриле', 'Морепродукты', 4800, 'Рыба на гриле', 'сибас,лимон'),
(26, 'Манты', 'Узбекская кухня', 1800, 'Паровые манты', 'тесто,тыква'),
(27, 'Шурпа', 'Узбекская кухня', 2200, 'Суп из баранины', 'баранина,овощи'),
(28, 'Цезарь с курицей', 'Салаты', 1800, 'Салат Цезарь', 'курица,салат,соус'),
(29, 'Греческий салат', 'Салаты', 1600, 'Салат с фетой', 'огурцы,помидоры,фета'),
(30, 'Тирамису', 'Десерты', 2200, 'Итальянский десерт', 'маскарпоне,кофе');

-- Связь ресторанов и блюд
INSERT INTO restaurant_dishes (restaurant_id, dish_id) VALUES
(1,1),(1,2),(1,8),(2,5),(2,9),(2,23),(3,6),(3,28),(3,29),(4,9),(4,23),
(5,8),(6,15),(6,22),(7,9),(7,23),(8,10),(8,5),(9,10),(9,27),(10,11),(10,25),
(11,12),(12,7),(12,13),(13,14),(13,16),(14,8),(15,15),(15,22),
(16,14),(16,16),(17,3),(17,17),(17,20),(18,18),(18,15),(19,7),(19,19),
(20,15),(21,3),(21,17),(21,20),(22,4),(22,21),(23,26),(24,9),(24,23),
(25,22),(25,15),(26,9),(26,23),(27,9),(27,23),(28,24),(28,28),
(29,11),(29,25),(30,4),(30,21),(31,7),(31,13);

COMMIT;
